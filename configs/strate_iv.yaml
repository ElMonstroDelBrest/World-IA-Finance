# Strate IV â€” Latent Regime RL configuration (v5)
# obs_dim is auto-detected from buffer (3*d_model + n_tgt*4 + 5 + 4)

env:
  n_tgt: 8              # episode length in patches (8 x 16h = 128h ~ 5.3 days)
  tc_rate: 0.002        # transaction cost per unit position change (20 bps)
  patch_len: 16          # candles per patch (must match Strate I/II tokenizer)
  dead_market_threshold: 1.0e-4  # relative vol below which signals are zeroed (noise gate)

buffer:
  buffer_dir: "data/trajectory_buffer_v5/"
  n_episodes: 5000       # v5: 10x more episodes (3000 multiverse + 2000 historical)
  n_futures: 16          # N future trajectories per episode
  val_ratio: 0.1         # fraction held out for evaluation

ppo:
  lr: 1.5e-4             # v5: more conservative for larger policy network
  n_steps: 512           # per env (x8 envs = 4096 effective steps per rollout)
  batch_size: 256        # v5: larger minibatch
  n_epochs: 8            # v5: fewer SGD passes (less overfitting per rollout)
  gamma: 0.99
  gae_lambda: 0.95
  clip_range: 0.2
  ent_coef: 0.005        # v5: larger network = less entropy bonus needed
  vf_coef: 0.5
  max_grad_norm: 0.5
  total_timesteps: 2000000  # v5: 2M (5000 episodes = less overfitting risk)
  eval_freq: 20000
  log_dir: "tb_logs/strate_iv_v5/"
